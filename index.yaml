formats:
  - oas2
extends:
  - 'spectral:oas'
rules:
  info-description: error
  info-contact: error
  operation-tag-defined: error
  operation-operationId: error
  operation-tags: error
  fw-info-license:
    description: There should be a license section in the info section
    formats: [ "oas2", "oas3" ]
    given: $.info
    severity: error
    recommended: true
    then:
      field: license
      function: truthy
  fw-operation-summary:
    description: There should be a summary for each operation
    formats: [ "oas2", "oas3" ]
    given: $.paths[*][*]
    severity: error
    recommended: true
    then:
      field: summary
      function: truthy
  fw-schema-properties-example:
    description: Properties of the schemas should have an example value defined
    formats: [ "oas2" ]
    given: $.definitions..properties[*]
    severity: error
    recommended: true
    then:
      field: example
      function: truthy
  fw-properties-underscore-case:
    description: Properties of the schemas should be in underscore case
    formats: [ "oas2" ]
    given: $.definitions..properties[*]~
    severity: error
    recommended: true
    then:
      function: pattern
      functionOptions:
        match: "^[a-z0-9_]+$"
  fw-no-local-definition:
    description: Schema object should be defined in definitions
    formats: [ "oas2" ]
    given: $.paths..schema
    severity: error
    recommended: true
    then:
      field: type
      function: pattern
      functionOptions:
        notMatch: /object/i
  fw-ensure-no-legacy-tags:
    description: Tags should not have legacy in its name
    formats: [ "oas2", "oas3" ]
    given: $.tags[*]
    severity: error
    recommended: true
    then:
      field: name
      function: pattern
      functionOptions:
        notMatch: /legacy/i
  fw-path-kebab-case:
    description: Path should be in kebab case
    given: $.paths[*]~
    severity: error
    recommended: true
    then:
      function: pattern
      functionOptions:
        match: "^\/(((api\/_)?)|([a-z0-9]+(-[a-z0-9]+)*))?(\/[a-z0-9]+(-[a-z0-9]+)*|\/{.+})*$"
  fw-path-param-underscore-case:
    description: Parameter should be in underscore case
    given: $..parameters[?(@.in == 'path')].name
    severity: error
    recommended: true
    then:
      function: pattern
      functionOptions:
        match: "^[a-z0-9_]+$"
